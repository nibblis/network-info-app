# Демонстрация работы с Linter и статическим анализом

Этот документ объясняет, как использовать статический анализатор (Linter) для улучшения качества и безопасности кода.

### 1. Что такое Linter?

**Android Lint** — это встроенный в Android Studio статический анализатор кода. Он сканирует ваши файлы (Kotlin, XML, Gradle) на наличие потенциальных багов, проблем с производительностью, безопасностью, доступностью (accessibility) и стилем кода, **не запуская само приложение**.

### 2. Конфигурация Линтера

Управлять правилами можно централизованно через `build.gradle.kts`.

**Пример (`app/build.gradle.kts`):**

```kotlin
android {
    lint {
        // Если true, сборка упадет, если линтер найдет ошибки уровня 'error'
        abortOnError = true

        // Отключить проверку для конкретного правила
        disable.add("ContentDescription")

        // Изменить уровень серьезности для правила (например, с warning на error)
        error.add("HardcodedText")

        // Создать HTML-отчет после сборки
        htmlReport = true
    }
}
```

#### Уровни правил (Severity Levels)
-   `informational`: Просто информация.
-   `warning`: Потенциальная проблема. Сборка не падает.
-   `error`: Серьезная проблема. Может остановить сборку, если `abortOnError = true`.
-   `fatal`: Критическая ошибка, сборка всегда падает.

### 3. Запуск и Отчет CI

-   **Запуск вручную**: В Android Studio `Analyze -> Inspect Code...`.
-   **Запуск через Gradle**: `./gradlew lintDebug`. Эта команда сгенерирует подробный HTML-отчет.

**Отчет на CI (Continuous Integration):**
После каждой сборки на CI (например, Jenkins, GitHub Actions) можно настроить запуск `lint`. Сгенерированный HTML-отчет (`app/build/reports/lint-results-debug.html`) прикрепляется к результатам сборки. Это позволяет команде видеть все проблемы, не запуская проверку локально.

### 4. Исправление типовых проблем

#### Проблема 1: Hardcoded Text (Жестко закодированный текст)

-   **Что это:** Текст в XML-разметке задан напрямую, а не через строковые ресурсы.
-   **Почему плохо:** Приложение нельзя будет перевести на другие языки.
-   **❌ Плохо:** `<TextView android:text="Hello World" ... />`
-   **✔️ Хорошо:**
    1.  В `res/values/strings.xml`: `<string name="hello_world">Hello World</string>`
    2.  В разметке: `<TextView android:text="@string/hello_world" ... />`

#### Проблема 2: ContentDescription (Описание контента)

-   **Что это:** У `ImageView` или `ImageButton` отсутствует атрибут `android:contentDescription`.
-   **Почему плохо:** Нарушает **accessibility** (доступность). Люди с нарушениями зрения, использующие TalkBack, не поймут, что изображено на кнопке.
-   **❌ Плохо:** `<ImageButton android:src="@drawable/ic_search" ... />`
-   **✔️ Хорошо:** `<ImageButton android:src="@drawable/ic_search" android:contentDescription="@string/search_button_description" ... />`

#### Проблема 3: Using obsolete methods (Использование устаревших методов)

-   **Что это:** Вызов метода, который помечен как устаревший (`deprecated`).
-   **Почему плохо:** В будущих версиях Android этот метод может быть удален или перестать работать.
-   **Пример:** Использование старого конструктора `AsyncTask`.
-   **Решение:** Линтер и документация всегда подскажут, какую новую конструкцию следует использовать (например, корутины вместо `AsyncTask`).

### 5. Подавление предупреждений (Suppress)

Иногда линтер неправ, или вы сознательно идете на нарушение. В таких случаях предупреждение можно подавить.

-   **В Kotlin/Java коде (через аннотацию):**

    ```kotlin
    // Подавляем только для этого метода
    @SuppressLint("HardcodedText")
    fun showDebugMessage() {
        myTextView.text = "DEBUG MODE ACTIVE" // Техническое сообщение, не требующее перевода
    }
    ```

-   **В XML (через атрибут `tools`):**

    ```xml
    <TextView
        xmlns:tools="http://schemas.android.com/tools"
        android:text="12:00"
        tools:ignore="HardcodedText" /> <!-- Временная метка, не требующая перевода -->
    ```

**Важно:** Используйте подавление точечно и только тогда, когда вы на 100% уверены, что проблемы нет. Всегда оставляйте комментарий, объясняющий, почему предупреждение было проигнорировано.
